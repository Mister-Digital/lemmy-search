FROM rust:slim-bookworm AS build

WORKDIR /build
COPY ./ ./

RUN cargo build -- release

FROM gcr.io/distroless/static-debian11:latest

COPY --from=build /build/target/release/lemmy-search /bin/lemmy-search

EXPOSE 80
ENTRYPOINT [ "/bin/lemmy-search" ]
